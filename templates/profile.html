<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>{{ title }}</title>
    <style>
        body { font-family: Arial, sans-serif; background-color: #f4f4f4; display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; }
        .card { background: white; padding: 40px; border-radius: 10px; box-shadow: 0 4px 8px rgba(0,0,0,0.1); text-align: center; width: 350px; }
        .profile-image {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            object-fit: cover;
            margin-bottom: 20px;
            border: 4px solid #eee;
        }
        h1 { margin-top: 0; color: #333; }
        p { color: #666; font-size: 1.2em; }
        .home-link { display: inline-block; margin-top: 25px; padding: 10px 20px; background: #333; color: white; text-decoration: none; border-radius: 5px; }
        
        /* New styles for the form */
        form { margin-top: 20px; border-top: 1px solid #eee; padding-top: 20px; }
        input[type="file"] { display: block; margin: 10px auto; }
        button { background: #5cb85c; color: white; padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer; }
        
        /* New styles for flash messages */
        .flash { padding: 10px; background: #dff0d8; color: #3c763d; border: 1px solid #d6e9c6; border-radius: 5px; margin-bottom: 15px; }
    </style>
</head>
<body>
    <div class="card">
        
        <!-- This block will display flash messages -->
        {% with messages = get_flashed_messages() %}
            {% if messages %}
                <div class="flash">{{ messages[0] }}</div>
            {% endif %}
        {% endwith %}

        <img class="profile-image" src="{{ url_for('static', filename='profile_pics/' + current_user.profile_image) }}" alt="Profile Picture">

        <h1>{{ current_user.nickname }}</h1>
        <p>Your Email: {{ current_user.email }}</p>

        <!-- NEW UPLOAD FORM -->
        <form method="POST" action="" enctype="multipart/form-data">
            <div>
                <label for="profile_image">Update Profile Picture</label>
                <input type="file" id="profile_image" name="profile_image" accept="image/png, image/jpeg, image/jpg">
            </div>
            <button type="submit">Upload Image</button>
        </form>
        
        <a href="{{ url_for('main.home') }}" class="home-link">Back to Chat</a>
    </div>
</body>
</html>